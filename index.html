<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>App Status Dashboard</title>
      <style>
         body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
         }
         header {
            background-color: #2c3e50;
            color: #fff;
            padding: 10px 20px;
            text-align: center;
         }
         .container {
            margin: 10px;
            padding: 10px;
         }
         .search-container {
            margin: 20px 0;
            text-align: center;
         }
         .search-input {
            padding: 10px;
            font-size: 16px;
            width: 100%;
            max-width: 400px;
            border-radius: 4px;
            border: 1px solid #ccc;
         }
         .table-wrapper {
            display: block; /* Allow scrolling */
            overflow-x: auto; /* Enable horizontal scrolling */
            max-width: 100%;
            margin: 20px auto;
         }
         table {
            width: 100%;
            min-width: 800px; /* Set a minimum width */
            border-collapse: collapse;
            margin: 0;
         }
         th,
         td {
            padding: 10px;
            text-align: center;
            word-wrap: break-word;
            border: 1px solid #ddd;
         }
         th {
            background-color: #34495e;
            color: #fff;
         }
         tr:nth-child(even) {
            background-color: #f2f2f2;
         }
         .status {
            font-weight: bold;
         }
         .status-up {
            color: green;
         }
         .status-down {
            color: red;
         }
         .highlighted {
            background-color: #cecece;
         }
         .hidden {
            display: none;
         }
         @media (max-width: 768px) {
            table {
               font-size: 14px;
            }
            th,
            td {
               padding: 8px;
            }
            .search-input {
               font-size: 14px;
            }
         }
         @media (max-width: 480px) {
            .table-wrapper {
               padding: 0 10px; /* Add padding for better appearance */
            }
            table {
               font-size: 12px; /* Reduce font size for smaller screens */
            }
            th,
            td {
               padding: 5px; /* Adjust padding */
            }
         }
      </style>
   </head>
   <body>
      <header>
         <h1>Bot Status Dashboard</h1>
      </header>
      <div class="container">
         <div class="search-container">
            <input type="text" id="searchInput" class="search-input" placeholder="Search for Server IDs..." aria-label="Search for Server IDs">
         </div>
         <div class="table-wrapper">
            <table>
               <thead>
                  <tr>
                     <th>Bot ID</th>
                     <th>Shard ID</th>
                     <th>Last Update</th>
                     <th>Last Uptime</th>
                     <th>Cached Guilds</th>
                     <th>Cached Members</th>
                     <th class="hidden">Server IDs</th>
                     <th>Current Ping</th>
                     <th>Status</th>
                  </tr>
               </thead>
               <tbody id="statusTable">
               </tbody>
            </table>
         </div>
      </div>
      <script>
         document.addEventListener("DOMContentLoaded", () => {
           const statusTable = document.getElementById("statusTable");
           const searchInput = document.getElementById("searchInput");
         
           function timeAgo(ms) {
             const seconds = Math.floor(ms / 1000);
             const minutes = Math.floor(seconds / 60);
             const hours = Math.floor(minutes / 60);
             const days = Math.floor(hours / 24);
             const weeks = Math.floor(days / 7);
             
             if (weeks > 0) return `${weeks} week${weeks > 1 ? 's' : ''} ago`;
             if (days > 0) return `${days} day${days > 1 ? 's' : ''} ago`;
             if (hours > 0) return `${hours} hour${hours > 1 ? 's' : ''} ago`;
             if (minutes > 0) return `${minutes} minute${minutes > 1 ? 's' : ''} ago`;
             return `${seconds} second${seconds > 1 ? 's' : ''} ago`;
           }
         
           function formatDuration(ms) {
             const minutes = Math.floor(ms / 60000);
             const hours = Math.floor(minutes / 60);
             const days = Math.floor(hours / 24);
             const weeks = Math.floor(days / 7);
         
             return [
               weeks && `${weeks} week${weeks > 1 ? 's' : ''}`,
               days % 7 && `${days % 7} day${days % 7 > 1 ? 's' : ''}`,
               hours % 24 && `${hours % 24} hour${hours % 24 > 1 ? 's' : ''}`,
               minutes % 60 && `${minutes % 60} minute${minutes % 60 > 1 ? 's' : ''}`
             ].filter(Boolean).join(' ') || "Less than a minute";
           }
         
           let bots = [];
           let filteredBots = [];
         
           let debounceTimeout;
           function debounce(callback, delay) {
             clearTimeout(debounceTimeout);
             debounceTimeout = setTimeout(callback, delay);
           }
         
           function renderRows(botsToRender) {
             const fragment = document.createDocumentFragment();
         
             botsToRender.forEach(bot => {
               const row = document.createElement("tr");
         
               if (bot.bot_id === "1280984633739186318") {
                 row.classList.add("highlighted");
               }
         
               row.innerHTML = `
                 <td>${bot.bot_id}</td>
                 <td>${bot.shard_id}</td>
                 <td>${timeAgo(Date.now() - parseInt(bot.last_update))}</td>
                 <td>${formatDuration(Date.now() - parseInt(bot.starting_time))}</td>
                 <td>${bot.max_server_count}</td>
                 <td>${bot.max_member_count}</td>
                 <td class="hidden">${bot.server_ids?.join(", ") || "N/A"}</td>
                 <td>${bot.average_ping > 0 ? bot.average_ping : "N/A"}</td>
                 <td><span class="status ${bot.average_ping > 0 ? "status-up" : "status-down"}">${bot.average_ping > 0 ? "Up" : "Down"}</span></td>
               `;
         
               fragment.appendChild(row);
             });
         
             statusTable.innerHTML = '';
             statusTable.appendChild(fragment);
           }
         
           fetch('https://status.faizo.top/api/quicksupport', {
             headers: {
               'Cache-Control': 'public, max-age=600'
             }
           })
           .then(response => response.json())
           .then(botData => {
             bots = botData.sort((a, b) => b.max_server_count - a.max_server_count);
             filteredBots = bots;
             renderRows(filteredBots);
         
             searchInput.addEventListener('input', event => {
               debounce(() => {
                 const searchTerm = event.target.value.toLowerCase();
                 filteredBots = bots.filter(bot => bot.server_ids?.some(id => id.toLowerCase().includes(searchTerm)));
                 renderRows(filteredBots);
               }, 500);
             });
           })
           .catch(error => {
             console.error("Error fetching data:", error);
             statusTable.innerHTML = "<tr><td colspan='9'>Failed to load data. Please try again later.</td></tr>";
           });
         });
      </script>
   </body>
</html>
